import ADDRESSES from '../helpers/coreAssets.json'
import { FetchResultV2, FetchV2 } from "../adapters/types";
import { CHAIN } from "../helpers/chains";
import { httpGet } from "../utils/fetchURL";

const ROUTE_RP45_EVENT = 'event Route(address indexed from, address to, address indexed tokenIn, address indexed tokenOut, uint256 amountIn, uint256 amountOutMin,uint256 amountOut)'
const ROUTE_RP6_EVENT = 'event Route(address indexed from, address to, address indexed tokenIn, address tokenOut, uint256 amountIn, uint256 amountOutMin, uint256 amountOut, int256 slippage, uint32 indexed referralCode)'
const ROUTE_RP7_EVENT = 'event Route(address indexed from, address to, address indexed tokenIn, address tokenOut, uint256 amountIn, uint256 amountOut, int256 slippage, uint32 indexed referralCode)'

const CHAIN_ID: any = {
  [CHAIN.ETHEREUM]: 1,
  [CHAIN.ARBITRUM]: 42161,
  [CHAIN.OPTIMISM]: 10,
  [CHAIN.BASE]: 8453,
  [CHAIN.POLYGON]: 137,
  [CHAIN.AVAX]: 43114,
  [CHAIN.BSC]: 56,
  [CHAIN.LINEA]: 59144,
  [CHAIN.ARBITRUM_NOVA]: 42170,
  [CHAIN.XDAI]: 100,
  [CHAIN.FANTOM]: 250,
  [CHAIN.BITTORRENT]: 199,
  [CHAIN.CELO]: 42220,
  [CHAIN.FILECOIN]: 314,
  [CHAIN.HAQQ]: 11235,
  [CHAIN.KAVA]: 2222,
  [CHAIN.METIS]: 1088,
  [CHAIN.THUNDERCORE]: 108,
  [CHAIN.SCROLL]: 534352,
  [CHAIN.ZETA]: 7000,
  [CHAIN.MOONBEAM]: 1284,
  [CHAIN.MOONRIVER]: 1285,
  [CHAIN.POLYGON_ZKEVM]: 1101,
  [CHAIN.FUSE]: 122,
  [CHAIN.HARMONY]: 1666600000,
  [CHAIN.TELOS]: 40,
  [CHAIN.BOBA]: 288,
  [CHAIN.BOBA_BNB]: 56288,
  [CHAIN.CORE]: 1116,
  [CHAIN.CRONOS]: 81457,
  [CHAIN.BLAST]: 81457,
  [CHAIN.SKALE_EUROPA]: 2046399126,
  [CHAIN.ROOTSTOCK]: 30,
  [CHAIN.MANTLE]: 5000,
  [CHAIN.ERA]: 324,
  [CHAIN.MANTA]: 169,
  [CHAIN.MODE]: 34443,
  [CHAIN.TAIKO]: 167000,
  [CHAIN.ZKLINK]: 810180,
  [CHAIN.APECHAIN]: 33139,
  [CHAIN.SONIC]: 146,
  [CHAIN.HEMI]: 43111,
}

const RP4_ADDRESS: any = {
  [CHAIN.ETHEREUM]: '0xe43ca1Dee3F0fc1e2df73A0745674545F11A59F5',
  [CHAIN.ARBITRUM]: '0x544bA588efD839d2692Fc31EA991cD39993c135F',
  [CHAIN.OPTIMISM]: '0x1f2FCf1d036b375b384012e61D3AA33F8C256bbE',
  [CHAIN.BASE]: '0x0389879e0156033202c44bf784ac18fc02edee4f',
  [CHAIN.POLYGON]: '0x46B3fDF7b5CDe91Ac049936bF0bDb12c5d22202e',
  [CHAIN.AVAX]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.BSC]: '0x33d91116e0370970444B0281AB117e161fEbFcdD',
  [CHAIN.LINEA]: '0x46b3fdf7b5cde91ac049936bf0bdb12c5d22202e',
  [CHAIN.ARBITRUM_NOVA]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.XDAI]: '0x46b3fdf7b5cde91ac049936bf0bdb12c5d22202e',
  [CHAIN.FANTOM]: '0x46b3fdf7b5cde91ac049936bf0bdb12c5d22202e',
  [CHAIN.BITTORRENT]: '0x93c31c9C729A249b2877F7699e178F4720407733',
  [CHAIN.CELO]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.FILECOIN]: '0x1f2FCf1d036b375b384012e61D3AA33F8C256bbE',
  [CHAIN.HAQQ]: '0xc3Ec4e1511c6935ed2F92b9A61881a1B95bB1566',
  [CHAIN.KAVA]: '0xB45e53277a7e0F1D35f2a77160e91e25507f1763',
  [CHAIN.METIS]: '0xB45e53277a7e0F1D35f2a77160e91e25507f1763',
  [CHAIN.THUNDERCORE]: '0x57bfFa72db682f7eb6C132DAE03FF36bBEB0c459',
  [CHAIN.SCROLL]: '0x734583f62Bb6ACe3c9bA9bd5A53143CA2Ce8C55A',
  [CHAIN.ZETA]: '0x640129e6b5C31B3b12640A5b39FECdCa9F81C640',
  [CHAIN.MOONBEAM]: '0xB45e53277a7e0F1D35f2a77160e91e25507f1763',
  [CHAIN.MOONRIVER]: '0x46B3fDF7b5CDe91Ac049936bF0bDb12c5d22202e',
  [CHAIN.POLYGON_ZKEVM]: '0x57bfFa72db682f7eb6C132DAE03FF36bBEB0c459',
  [CHAIN.FUSE]: '0x46B3fDF7b5CDe91Ac049936bF0bDb12c5d22202e',
  [CHAIN.HARMONY]: '0x9B3336186a38E1b6c21955d112dbb0343Ee061eE',
  [CHAIN.TELOS]: '0x1400feFD6F9b897970f00Df6237Ff2B8b27Dc82C',
  [CHAIN.BOBA]: '0xe43ca1Dee3F0fc1e2df73A0745674545F11A59F5',
  [CHAIN.BOBA_BNB]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.CORE]: '0x0389879e0156033202C44BF784ac18fC02edeE4f',
  [CHAIN.CRONOS]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.BLAST]: '0xCdBCd51a5E8728E0AF4895ce5771b7d17fF71959',
  [CHAIN.SKALE_EUROPA]: '0xbA61F775730C0a3E3361717195ee86785ee33055',
  [CHAIN.ROOTSTOCK]: '0xb46e319390De313B8cc95EA5aa30C7bBFD79Da94',
}

const RP5_ADDRESS: any = {
  [CHAIN.ETHEREUM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ARBITRUM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.OPTIMISM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BASE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.POLYGON]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.AVAX]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BSC]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.LINEA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ARBITRUM_NOVA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.XDAI]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.FANTOM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BITTORRENT]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.CELO]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.FILECOIN]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.HAQQ]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.KAVA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.METIS]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.THUNDERCORE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.SCROLL]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ZETA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.MOONBEAM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.MOONRIVER]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.POLYGON_ZKEVM]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.FUSE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.HARMONY]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.TELOS]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BOBA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BOBA_BNB]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.CORE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.CRONOS]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.BLAST]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.SKALE_EUROPA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ROOTSTOCK]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.MANTLE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ERA]: '0x9e55e562D40FD01f38cD4057e632352fE0758F16',
  [CHAIN.MANTA]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.MODE]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.TAIKO]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
  [CHAIN.ZKLINK]: '0x9e55e562D40FD01f38cD4057e632352fE0758F16',
  [CHAIN.APECHAIN]: '0xf2614A233c7C3e7f08b1F887Ba133a13f1eb2c55',
}

const RP6_ADDRESS: any = {
  [CHAIN.ETHEREUM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ARBITRUM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.OPTIMISM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BASE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.POLYGON]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.AVAX]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BSC]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.LINEA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ARBITRUM_NOVA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.XDAI]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.FANTOM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BITTORRENT]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.CELO]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.FILECOIN]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.HAQQ]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.KAVA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.METIS]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.THUNDERCORE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.SCROLL]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ZETA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.MOONBEAM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.MOONRIVER]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.POLYGON_ZKEVM]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.FUSE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.HARMONY]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.TELOS]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BOBA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BOBA_BNB]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.CORE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.CRONOS]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.BLAST]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.SKALE_EUROPA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ROOTSTOCK]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ERA]: '0xE6fD46600A97CE06703b58333B9C2399F4bF6FEc',
  [CHAIN.MANTLE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.MANTA]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.MODE]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.TAIKO]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.ZKLINK]: '0xE6fD46600A97CE06703b58333B9C2399F4bF6FEc',
  [CHAIN.APECHAIN]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.SONIC]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71',
  [CHAIN.HEMI]: '0x85CD07Ea01423b1E937929B44E4Ad8c40BbB5E71'
}

const RP7_ADDRESS: any = {
  [CHAIN.ETHEREUM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ARBITRUM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.OPTIMISM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BASE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.POLYGON]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.AVAX]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BSC]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.LINEA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ARBITRUM_NOVA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.XDAI]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.FANTOM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BITTORRENT]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.CELO]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.FILECOIN]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.HAQQ]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.KAVA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.METIS]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.THUNDERCORE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.SCROLL]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ZETA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.MOONBEAM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.MOONRIVER]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.POLYGON_ZKEVM]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.FUSE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.HARMONY]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.TELOS]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BOBA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BOBA_BNB]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.CORE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.CRONOS]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.BLAST]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.SKALE_EUROPA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ROOTSTOCK]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ERA]: '0xd7C94C8C61628911C41141289af1D0dE17d7aC8d',
  [CHAIN.MANTLE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.MANTA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.MODE]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.TAIKO]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.ZKLINK]: '0xd7C94C8C61628911C41141289af1D0dE17d7aC8d',
  [CHAIN.APECHAIN]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.SONIC]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.HEMI]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
  [CHAIN.KATANA]: '0x3Ced11c610556e5292fBC2e75D68c3899098C14C',
}

const RP8_ADDRESS: any = {
  [CHAIN.ETHEREUM]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.ARBITRUM]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.OPTIMISM]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.BASE]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.POLYGON]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.MOONBEAM]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.POLYGON_ZKEVM]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.MANTLE]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
  [CHAIN.KATANA]: '0x2905d7e4D048d29954F81b02171DD313F457a4a4',
}

const WNATIVE_ADDRESS: any = {
  [CHAIN.ETHEREUM]: ADDRESSES.ethereum.WETH,
  [CHAIN.ARBITRUM]: ADDRESSES.arbitrum.WETH,
  [CHAIN.OPTIMISM]: ADDRESSES.optimism.WETH_1,
  [CHAIN.BASE]: ADDRESSES.optimism.WETH_1,
  [CHAIN.POLYGON]: ADDRESSES.polygon.WMATIC_2,
  [CHAIN.AVAX]: ADDRESSES.avax.WAVAX,
  [CHAIN.BSC]: ADDRESSES.bsc.WBNB,
  [CHAIN.LINEA]: ADDRESSES.linea.WETH,
  [CHAIN.ARBITRUM_NOVA]: ADDRESSES.arbitrum_nova.WETH,
  [CHAIN.XDAI]: ADDRESSES.xdai.WXDAI,
  [CHAIN.FANTOM]: ADDRESSES.fantom.WFTM,
  [CHAIN.BITTORRENT]: ADDRESSES.bittorrent.WBTT,
  [CHAIN.CELO]: ADDRESSES.celo.CELO,
  [CHAIN.FILECOIN]: '0x60e1773636cf5e4a227d9ac24f20feca034ee25a',
  [CHAIN.HAQQ]: ADDRESSES.islm.ISLM,
  [CHAIN.KAVA]: ADDRESSES.kava.WKAVA,
  [CHAIN.METIS]: '0x75cb093e4d61d2a2e65d8e0bbb01de8d89b53481',
  [CHAIN.THUNDERCORE]: ADDRESSES.thundercore.WTT,
  [CHAIN.SCROLL]: ADDRESSES.scroll.WETH,
  [CHAIN.ZETA]: ADDRESSES.zeta.WZETA,
  [CHAIN.MOONBEAM]: '0xacc15dc74880c9944775448304b263d191c6077f',
  [CHAIN.MOONRIVER]: '0xf50225a84382c74cbdea10b0c176f71fc3de0c4d',
  [CHAIN.POLYGON_ZKEVM]: ADDRESSES.polygon_zkevm.WETH,
  [CHAIN.FUSE]: ADDRESSES.fuse.WFUSE,
  [CHAIN.HARMONY]: ADDRESSES.harmony.WONE,
  [CHAIN.TELOS]: ADDRESSES.telos.WTLOS,
  [CHAIN.BOBA]: ADDRESSES.metis.Metis,
  [CHAIN.BOBA_BNB]: '0xc58aad327d6d58d979882601ba8dda0685b505ea',
  [CHAIN.CORE]: ADDRESSES.core.WCORE,
  [CHAIN.CRONOS]: ADDRESSES.cronos.WCRO_1,
  [CHAIN.BLAST]: ADDRESSES.blast.WETH,
  [CHAIN.SKALE_EUROPA]: ADDRESSES.null,
  [CHAIN.ROOTSTOCK]: ADDRESSES.rsk.WRBTC1,
  [CHAIN.MANTLE]: ADDRESSES.mantle.WMNT,
  [CHAIN.ERA]: ADDRESSES.era.WETH,
  [CHAIN.MANTA]: ADDRESSES.manta.WETH,
  [CHAIN.MODE]: ADDRESSES.optimism.WETH_1,
  [CHAIN.TAIKO]: ADDRESSES.taiko.WETH,
  [CHAIN.ZKLINK]: ADDRESSES.zklink.WETH,
  [CHAIN.APECHAIN]: ADDRESSES.apechain.WAPE,
  [CHAIN.SONIC]: ADDRESSES.sonic.wS,
  [CHAIN.HEMI]: ADDRESSES.optimism.WETH_1,
  [CHAIN.KATANA]: ADDRESSES.optimism.WETH_1,
}

const useSushiAPIPrice = (chain: any) => [
  CHAIN.BOBA_BNB,
  CHAIN.MOONRIVER
].includes(chain)

interface Log {
  tokenIn: string;
  amountIn: string;
}

const fetch: FetchV2 = async ({ getLogs, createBalances, chain }): Promise<FetchResultV2> => {
  const logsPromises: Promise<Log[]>[] = []

  if (RP4_ADDRESS[chain]) {
    logsPromises.push(getLogs({ target: RP4_ADDRESS[chain], eventAbi: ROUTE_RP45_EVENT }))
  }
  if (RP5_ADDRESS[chain]) {
    logsPromises.push(getLogs({ target: RP5_ADDRESS[chain], eventAbi: ROUTE_RP45_EVENT }))
  }
  if (RP6_ADDRESS[chain]) {
    logsPromises.push(getLogs({ target: RP6_ADDRESS[chain], eventAbi: ROUTE_RP6_EVENT }))
  }
  if (RP7_ADDRESS[chain]) {
    logsPromises.push(getLogs({ target: RP7_ADDRESS[chain], eventAbi: ROUTE_RP7_EVENT }))
  }
  if (RP8_ADDRESS[chain]) {
    logsPromises.push(getLogs({ target: RP8_ADDRESS[chain], eventAbi: ROUTE_RP7_EVENT }))
  }

  const logs = (await Promise.all(logsPromises)).flat()

  if (useSushiAPIPrice(chain)) {
    const dailyVolume = createBalances()
    const tokenPrice = Object.entries(await httpGet(`https://api.sushi.com/price/v1/${CHAIN_ID[chain]}`)).reduce((acc, [key, value]: any) => {
      acc[key.toLowerCase()] = value
      return acc
    });
    const tokensIn =  [...new Set(logs.map(log => log.tokenIn.toLowerCase()))]
    const tokensInfo = (await Promise.all(tokensIn.map(token => httpGet(`https://api.sushi.com/token/v1/${CHAIN_ID[chain]}/${token}`)))).flat();

    const tokens = tokensInfo.reduce((tokens, token) => {
      const address = token.address.toLowerCase()
      tokens[address] = {
        ...token,
        price: tokenPrice[address] ?? 0
      }

      return tokens
    }, {});

    logs.forEach((log) => {
      const token = tokens[log.tokenIn.toLowerCase()]
      if (token && log.tokenIn.toLowerCase() !== ADDRESSES.GAS_TOKEN_2.toLowerCase()) {
        const _dailyVolume = Number(log.amountIn) * token.price / 10 ** token.decimals
        if (_dailyVolume < 0) throw new Error(`Daily volume cannot be negative. Current value: ${_dailyVolume}`)
        dailyVolume.addUSDValue(_dailyVolume)
      } else {
        if (Number(log.amountIn) < 0) throw new Error(`Amount cannot be negative. Current value: ${log.amountIn}`)
        dailyVolume.add(WNATIVE_ADDRESS[chain], log.amountIn)
      }
    })

    return { dailyVolume }
  } else {
    const dailyVolume = createBalances()

    logs.forEach((log) => {
      if (Number(log.amountIn) < 0) throw new Error(`Amount cannot be negative. Current value: ${log.amountIn}`)
      if (log.tokenIn.toLowerCase() === ADDRESSES.GAS_TOKEN_2.toLowerCase())
        dailyVolume.addGasToken(log.amountIn)
      else
        dailyVolume.add(log.tokenIn, log.amountIn)
    })

    return { dailyVolume }
  }
}

const adapters = {
  [CHAIN.ARBITRUM]: {
    fetch,
    start: '2024-02-25',
  },
  [CHAIN.ARBITRUM_NOVA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.AVAX]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.BASE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.BLAST]: {
    fetch,
    start: '2024-03-01'
  },
  [CHAIN.BOBA]: {
    fetch,
    start: '2024-03-22'
  },
  [CHAIN.BOBA_BNB]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.BSC]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.BITTORRENT]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.CELO]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.CORE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.ETHEREUM]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.FANTOM]: {
    fetch,
    start: '2024-02-25'
  },
  // [CHAIN.FILECOIN]: {
  //   fetch,
  //   start: '2024-02-25'
  // },
  [CHAIN.FUSE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.XDAI]: {
    fetch,
    start: '2024-02-25'
  },
  // [CHAIN.HAQQ]: {
  //   fetch,
  //   start: '2024-02-25'
  // },
  // [CHAIN.HARMONY]: {
  //   fetch,
  //   start: '2024-02-25'
  // },
  [CHAIN.KAVA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.LINEA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.METIS]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.MOONBEAM]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.MOONRIVER]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.OPTIMISM]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.POLYGON]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.POLYGON_ZKEVM]: {
    fetch,
    start: '2024-02-25'
  },
  // [CHAIN.ROOTSTOCK]: {
  //   fetch,
  //   start: '2024-05-21'
  // },
  [CHAIN.SCROLL]: {
    fetch,
    start: '2024-02-25'
  },
  // [CHAIN.SKALE_EUROPA]: {
  //   fetch,
  //   start: '2024-04-22'
  // },
  [CHAIN.THUNDERCORE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.ZETA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.MANTLE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.ERA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.MANTA]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.MODE]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.TAIKO]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.ZKLINK]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.APECHAIN]: {
    fetch,
    start: '2024-02-25'
  },
  [CHAIN.SONIC]: {
    fetch,
    start: '2025-02-19'
  },
  [CHAIN.HEMI]: {
    fetch,
    start: '2025-02-19'
  },
  [CHAIN.KATANA]: {
    fetch,
    start: '2025-07-01'
  }
}

export default {
  version: 2,
  adapter: adapters,
}
